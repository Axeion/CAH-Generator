<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Cards Against Humanity - Card Generator</title>
        <meta name="description" content="Generate your own, full size, Cards Against Humanity cards.">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha512-Dop/vW3iOtayerlYAqCgkVr2aTr2ErwwTYOvRFUpzl2VhCMJyjQF0Q9TjUXIo6JhuM/3i0vVEt2e/7QQmnHQqw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
		<!-- Google tag (gtag.js) -->
		<meta name="google-site-verification" content="Fw32VtOfNNMYuxwq-LDxGbzuY7QIxjvQmLuWnv6FTGY" />
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-C7FZLTKS4Q"></script>
			<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			
			gtag('config', 'G-C7FZLTKS4Q');
		</script>
	<style type="text/css">
	   body{
		font-family: 'Helvetica Neue LT,-apple-system,BlinkMacSystemFont,Helvetica Neue,Helveticabold,sans-serif';
	   }
	</style>
        <style>
            body {
                padding-bottom: 20px;
			}

			#disclaimer {
				font-size: x-small;
			}

			#card {
				background: #000;
				border-radius: 15px;
				box-shadow: 0px 0px 2px 1px #666;
				color: #fff;
				font-size: 28pt;
				line-height: 27pt;
				height: 350px;
				letter-spacing: 1px;
				margin: 20px 0 40px 0;
				padding: 20px;
				width: 250px;
			}

			#card p {
				font-size: 12pt;
				line-height: 14pt;
				margin: 25px 0 0 0;
				text-indent: 0;
			}

			#generator {
				padding-top: 40px;
			}

			#color-picker {
				padding-left: 10px;
			}

			.modal-body .col-md-4 {
				margin-top: 6px;
			}

			.tips li {
				margin-top: 6px;
			}

			.instructions {
				padding-left: 20px;
			}

			#icon {
			    width: 80%;
			}

			#customIcon {
			    width: 0.1px;
			    height: 0.1px;
			    opacity: 0;
			    overflow: hidden;
			    position: absolute;
			    z-index: -1;
			    
			}
			
			#customIconLabel {
			    margin-top: 20px;
			    visibility: hidden;
			}

        </style>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap-theme.min.css" integrity="sha512-iy8EXLW01a00b26BaqJWaCmk9fJ4PsMdgNRqV96KwMPSH+blO82OHzisF/zQbRIIi8m0PiO10dpS0QxrcXsisw==" crossorigin="anonymous" referrerpolicy="no-referrer" />		
        <link rel="stylesheet" href="css/main.css">

        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" integrity="sha512-3n19xznO0ubPpSwYCRRBgHh63DrV+bdZfHK52b1esvId4GsfwStQNPJFjeQos2h3JwCmZl0/LgLxSKMAI55hgw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->


    <div class="container">
      <div class="row">
        <div class="col-lg-3">
			  <div id="card">
					Cards<br/>
					Against<br/>
					Humanity<br/>
					<p>Custom Card Generator</p>
					<p>Classic-Style Logo Version</p>
					<p>     <img src="img/icons/blank-black.png" width="140" height="100"></p>								  
			  </div>
		</div>
		<div class="col-lg-6">
			<form id="generator" role="form">
<!--			<div inert class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>My apologies!</strong> This turned out to be more popular than I thought - resulting in my host putting some restrictions on my account. So for the moment I've had to disable the generator. I'm working to rearchitect the backend to resolve the issue. Sorry for the inconvenience.</div> -->
				<input type="hidden" name="batch-id" id="batch-id" value="">
				<div class="form-group">
					<label for="card-text">Card Text</label>
					<textarea class="form-control" name="card-text" id="card-text" rows="13"></textarea>
				</div>
				<div class="row">
					<div class="col-lg-3">
						<label>Card Color</label>
						<div id="color-picker">
							<div class="radio">
								<label>
									<input type="radio" name="card-color" id="card-color-white" value="white" checked>
									White
								</label>
							</div>
							<div class="radio">
								<label>
									<input type="radio" name="card-color" id="card-color-black" value="black">
									Black
								</label>
							</div>
						</div>
					</div>
					<div class="col-lg-4">
						<label>Expansion Icon</label>
							<select class="form-control input-sm" name="icon" id="icon">
								<option value="none">None</option>
								<option value="custom">Custom Icon</option>
								<option value="reddit">Reddit Alien</option>
								<option value="tj">T. J. Must Be Stopped</option>
								<option value="starwars">Star Wars</option>
								<option value="potter">Harry Potter</option>
								<option value="tardis">Doctor Who</option>
								<option value="Disney">Disney</option>
								<option value="n7">Mass Effect</option>
								<option value="tabletop">Table Top</option>
								<option value="pax">PAX Controller</option>
								<option value="ferengi">Ferengi Alliance</option>
								<option value="homestuck">Homestuck</option>
								<option value="out-of-line">Out of Line</option>
								<option value="reject">Thumbs Down</option>
								<option value="HOC">House of Cards</option>
								<option value="snow">Christmas Snowflake</option>
								<option value="hat">Santa Hat</option>
								<option value="hanukkah">Hanukkah Menorah</option>
								<option value="seasons-greetings">Seasons Greetings</option>
								<option value="maple">Canada Maple Leaf</option>
								<option value="au-emu">Australia Emu</option>
								<option value="uk-bulldog">UK Bulldog</option>
								<option value="jackwhite">Jack White</option>						
								<option value="post-trump">Post-Trump</option>
								<option value="rooserteeth">Rooster Teeth</option>
								<option value="db2">Desert Bus for Hope 2</option>
								<option value="devil">Devil</option>
								<option value="fascism">Fascism</option>
								<option value="apple">Apple</option>
								<option value="hidden">Hidden</option>
								<option value="abusrd-box">Absurd</option>
				                <option value="ai">AI</option>
			             		<option value="human">Human</option>
								<option value="1923">1923</option>
				   		        <option value="00-new">2000's</option>
						        <option value="90-new">90's</option>
						        <option value="ass">Ass</option>
						        <option value="clam">Clam</option>
						        <option value="clam2">Clam 2</option>
								<option value="climate-catastrophe">Climate</option>
								<option value="dad">Dad</option>
								<option value="everything-box">Everything</option>
								<option value="fantasy">Fantasy</option>
								<option value="few-extra">A Few Extra</option>
								<option value="food">Food</option>
								<option value="geek">Geek</option>
								<option value="jewish">Jewish</option>
								<option value="metro">Metro</option>
								<option value="period">Period</option>
								<option value="picture-1">Camera 1</option>
								<option value="picture-2">Camera 2</option>
								<option value="picture-3">Camera 3</option>
								<option value="pride">Pride</option>
								<option value="retail-product">Retail Product</option>
								<option value="saves-america">Saves America</option>
								<option value="scary">Scary</option>
								<option value="science">Science</option>
								<option value="scifi">Sci-Fi</option>
								<option value="theatre">Theatre</option>
								<option value="weed">Weed</option>
								<option value="written-by-kids">Written By Kids</option>
								<option value="www">WWW</option>
								<option value="retail">Shopping Bag</option>
								<option value="box">Box</option>
						        <option value="blackbox-press">BlackBox Press</option>
						        <option value="blue-box">Blue Box</option>
		                        <option value="red-box">Red Box</option>
		                        <option value="green-box">Green Box</option>
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								</select>
						<div>
							<label for="customIcon" id="customIconLabel" class="btn btn-default">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="17" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"/></svg>
							Choose a file&hellip;
							</label>
							<input type="file" name="customIcon" id="customIcon">
						</div>
					</div>
					<div class="col-lg-4">
						<label>Mechanic</label>
						<div id="mechanic">
							<div class="radio">
								<label>
									<input type="radio" name="mechanic" id="mechanic-none" value="none" checked disabled>
									None
								</label>
							</div>
							<div class="radio">
								<label>
									<input type="radio" name="mechanic" id="mechanic-p2" value="p2" disabled>
									Pick 2
								</label>
							</div>
							<div class="radio">
								<label>
									<input type="radio" name="mechanic" id="mechanic-d2p3" value="d2p3" disabled>
									Draw 2, Pick 3
								</label>
							</div>
							<div class="radio">
								<label>
									<input type="radio" name="mechanic" id="mechanic-gear" value="gear" disabled>
									Gears
								</label>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-4">
						<div class="form-group">
							<label for="img-file-prefix">File Prefix</label>
							<input class="form-control" name="img-file-prefix" id="img-file-prefix"></input>
						</div>
					</div>
				</div>
				<button type="button" data-loading-text="Generating..." class="btn btn-default pull-right" id="generate-button">
					Generate Cards
				</button>
			</form>
        </div>
        <div class="col-lg-3">
			<h2>Instructions</h2>
			<p class="instructions">Enter the text you want on a card, then click the button. This isn't exactly rocket surgery.</p>

			<h2>Tips</h2>
			<ul class="tips">
				<li>You can create up to <b>200 cards</b> at a time (One card per line).</li>
				<li>Use a single _ to create a full underlined line.</li>
				<li>Consecutive _'s can be used to customize underline length.</li>
				<li>Use \_ to preserve a single underscore.</li>				
				<li>Use double quotes to quote things. Single quotes are turned into apostrophes.</li>
				<li>You can have a newline appear in your card text by using \n.</li>
				<li>Custom icons should be 150x150.</li>
				<li>Be patient - it takes a while for the cards to generate.</li>
				<li>Looking for the <b>New</b> Style CAH logo? <a href="https://enderandrew.com/CAH-Generator-new/">Click here!</a></li>
				<!-- <li><p style="color:red" hidden="yes">"Logo Type" is currently under construction. This message will be removed when its working again.</p></li> -->		
			</ul>
        </div>
      </div>

	<hr>

		<div class="row">
			<div class="col-lg-3">
				<h2>Printing</h2>
				<p>
					The images produced are 1200 dpi, and intended for printing on actual cards from a professional printer. Extra margin is already included to account for bleed.
				</p>
				<p>
					In my experience the 63 x 88mm, 310 GSM linen finish cards at <a href="https://www.printerstudio.com/personalized/custom-playing-cards-blank-cards.html#63 x 88mm Custom Cards (Blank Cards)" target="_blank">Printer Studio</a> are the closest match to the CAH cards.  
				</p>
				<h2>Card Backs</h2>
				<p>Since the card backs never change, they aren't included with the generated cards. You can download them from the links below.</p>
				<ul class="tips">
					<li><a href="img/back-white.png" target="_blank">White Card Back</a></li>
					<li><a href="img/back-black.png" target="_blank">Black Card Back</a></li>
				</ul>
				<h2>Card Ideas</h2>
				<p>No terrible ideas coming to mind? Try looking for some inspiration here:</p>
				<ul class="tips">
					<li><a href="http://boardgamegeek.com/forum/383041/cards-against-humanity/general">BoardGameGeek</a></li>
					<li><a href="http://www.reddit.com/r/cardsagainsthumanity/">r/cardsgainsthumanity</a></li>
					<li><a href="http://www.reddit.com/r/CAHideas">r/CAHideas</a></li>
					<li><a href="http://www.reddit.com/r/upvoteagainsthumanity">r/upvoteagainsthumanity</a></li>
				</ul>
			</div>
			<div class="col-lg-3">
			    <h2>Common Sets</h2>
			    <p>Save yourself some time and grab these commonly generated sets without waiting:</p> 
			    <ul class="tips">
				<li><a href="img/sets/Brumfield1.zip">Brumfield 1 - My set (115 cards)</a></li>
				<li><a href="img/sets/Brumfield2.zip">Brumfield 2 - My set (115 cards)</a></li>
				<li><a href="img/sets/Brumfield3.zip">Brumfield 3 - My set (115 cards)</a></li>
				<li><a href="img/sets/Brumfield4.zip">Brumfield 4 - My set (310 cards!)</a></li>
				<li><a href="img/sets/Brumfield5.zip">Brumfield 5 - My set (115 cards)</a></li>
				<li><a href="img/sets/Disney.zip">Disney Will Sue a Bitch - My set (230 cards)</a></li>
				<li><a href="img/sets/MassEffect.zip">Mass Effect<sup>Updated!</sup> - Expanded by me (115 cards)</a></li>
				<li><a href="img/sets/Gallifrey.zip">Cards Against Gallifrey<sup>Updated!</sup> - Expanded by me (283 cards!)</a></li>
				<li><a href="img/sets/1923.zip">1923<sup>Updated!</sup> - Expanded by me (115 cards!)</a></li>
				<li><a href="img/sets/CATS.zip">CATS - Theatre variant (30 cards)</a></li>
				<li><a href="img/sets/80s.zip">Cords Against The 80's (115 cards)</a></li>
				<li><a href="img/sets/Cords1.zip">Cords Against Harmony 1 (108 cards)</a></li>
				<li><a href="img/sets/Cords2.zip">Cords Against Harmony 2 (108 cards)</a></li>
				<li><a href="img/sets/DesertBus.zip">Desert Bus for Hope (24 cards)</a></li>
				<li><a href="img/sets/Fascism.zip">Fascism (17 cards)</a></li>
				<li><a href="img/sets/Ferengi.zip">Ferengi Rules of Acquisition (112 cards)</a></li>
				<li><a href="img/sets/HanukkahLOL.zip">Hanukkah LOL (7 cards)</a></li>
				<li><a href="img/sets/Hidden.zip">Hidden Compartment (15 cards)</a></li>
				<li><a href="img/sets/HOC.zip">House of Cards (25 cards)</a></li> 
				<li><a href="img/sets/Jack_White.zip">Jack White Show (7 cards)</a></li>
				<li><a href="img/sets/Muggles.zip">Cards Against Muggles<sup>Updated!</sup> (1,340 cards!)</a></li>
				<li><a href="img/sets/PAX_East_2013_A_B_C.zip">PAX East 2013 (30 cards)</a></li>
				<li><a href="img/sets/PAX_East_2014.zip">PAX East 2014 (37 cards)</a></li>
				<li><a href="img/sets/PAX_Prime_2013.zip">PAX Prime 2013 (44 cards)</a></li>
				<li><a href="img/sets/PAX_Prime_2014.zip">PAX Prime 2014 (12 cards)</a></li>
				<li><a href="img/sets/Post-Trump.zip">Post-Trump (25 cards)</a></li>
				<li><a href="img/sets/Random1.zip">Random 1 (115 cards)</a></li>
				<li><a href="img/sets/Random2.zip">Random 2 (230 cards!)</a></li>
				<li><a href="img/sets/Reddit1.zip">Cards Against Reddit 1 (115 cards)</a></li>
				<li><a href="img/sets/Reddit2.zip">Cards Against Reddit 2 (115 cards)</a></li>
				<li><a href="img/sets/Reddit3.zip">Cards Against Reddit 3 (122 cards)</a></li>
				<li><a href="img/sets/StarWars.zip">Cards Against Star Wars (620 cards)</a></li>
				<li><a href="img/sets/Trekkies.zip">Cards Against Trekkies 1.1 (120 cards)</a></li>
			    </ul>
			</div>
			<div class="col-lg-3">
				<img src="img/HouseRules.jpg" alt="House Rules" class="center-block">
			</div>
		</div>


      <hr>

      <footer>
			<div class="row">
				<div class="col-lg-3">
				    <a href="https://github.com/brinsky"><img src="img/GitHub-Mark-32px.png" width="32" height="32" alt="Octocat"></a> This version pulls heavily from <a href="https://github.com/DJalup/CAH-Generator">this fork</a> on Github and...
				    <br>
				    <a href="https://github.com/DJalup"><img src="img/GitHub-Mark-32px.png" width="32" height="32" alt="Octocat"></a> also <a href="https://github.com/brinsky/CAH-Generator">this fork</a> on Github. I just combined some of the forks and added in tons of new expansion icons, and premade sets. I also made sure there were "mechanic" versions for all of the sets.
				</div>
				<div class="col-lg-3 col-lg-offset-6">
					<div id="disclaimer"><p>Cards Against Humanity is a trademark of Cards Against Humanity, LLC. and is distributed under the <a rel="license" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/2.0/"><img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-nc-sa/2.0/80x15.png"></a> license. Any trademark referenced in any of the card sets belongs to the respective trademark holder.</p><p>Cards Against Humanity is not affiliated with this site in any way (in fact, I'd be shocked if they know it exists).</p></div>
				</div>
			</div>
      </footer>
  </div> <!-- /container -->
<!-- Modal -->
<div inert class="modal fade" id="batchModal" tabindex="-1" role="dialog" aria-labelledby="batchModalLabel">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button inert type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title" id="batchModalLabel">Your Shitty Cards</h4>
      </div>
      <div class="modal-body">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-default" id="zipDownload" disabled>Download Zip</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-3.7.1.min.js"><\/script>')</script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha512-oBTprMeNEKCnqfuqKd6sbvFzmFQtlXS3e0C/RGFV0hD6QzhHV+ODfaQbAlmY6/q0ubbwlAM/nCJjkrgA3waLzg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.13.7/underscore-min.js" integrity="sha512-dvWGkLATSdw5qWb2qozZBRKJ80Omy2YN/aF3wTUVC5+D1eqbA+TjWpPpoj8vorK5xGLMa2ZqIeWCpDZP/+pQGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>
		
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-C7FZLTKS4Q"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'G-C7FZLTKS4Q');
		</script>

        <script>
            var _gaq=[['_setAccount','G-C7FZLTKS4Q'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src='//www.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));

			$( document ).ready(function() {
				$('input:radio[name=card-color]').change(function(e){
					if($(this).val() === 'black') {
						$('input:radio[name=mechanic]').prop('disabled', false);
					} else {
						$('input:radio[name=mechanic]').prop('disabled', true);
					}
				});

				$('#icon').change(function(e){
					if($(this).val() === 'custom') {
						$('#customIconLabel').css('visibility', 'visible');
					} else {
						$('#customIconLabel').css('visibility', 'hidden');
					}
				});

				$('#generator').submit(function(e) {
					var form = $(this), 
						button = $('#generate-button'),
						batch = 'submit_' + (Date.now()*Math.random()*100000).toString(36),
						dl_button = $('#zipDownload'),
						text = $('#card-text'),
						img_file_prefix_el = $('#img-file-prefix'),
						batch_count;
					
					$(".alert").alert('close')

					//dl_button.unbind('click');
					dl_button.prop('disabled', true);

					$('#batch-id').attr('value', batch);
					text.val(_.without(text.val().split('\n'), "").join('\n').replace(/([^_\\])_([^_])|([^_\\])_([^_]?)$|^([^_\\]?)_([^_])/g, '\$1\$3\$5___________________\$2\$4\$6').replace(/\\_/g, '_').replace(/"(.+?)"/g, "\\x{201C}\$1\\x{201D}").replace(/'/g, "\\x{2019}"));

					var img_file_prefix = img_file_prefix_el.val().replace(/[^\w\-]/g, '');
					img_file_prefix_el.val(img_file_prefix);
					if (img_file_prefix == '') {
						img_file_prefix = batch;
					}

					batch_count = text.val().split('\n').length;
					
					// Cards entered are valid
					if (batch_count < 201 && text.val() !== "") {
						button.button('loading');
						$.ajax({
							type: 'POST',
							url: 'generator.php',
							data: new FormData(document.forms.generator),
							cache: false,
							contentType: false,
							processData: false
						}).done(function(){
							dl_button.click(function(){
								window.location = 'files/' + batch + '/' + batch + '.zip';
							});

							dl_button.prop('disabled', false);
							button.button('reset')
						
						}).fail((jqXHR, textStatus, errorThrown) => {
							alert(`An Error Occurred, you should refresh the page.\nText status: ${textStatus}\nError thrown: ${errorThrown}`);
						})
						
						$('#batchModal').modal('show');
						view_batch(batch, batch_count, img_file_prefix);
					} else {
						// No cards were entered
						if (text.val() == "") {
							$('<div inert class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>Oh Snap!</strong> You didn\'t enter in any cards to generate, stupid.</div>').prependTo(form);
						}
						// Too many cards were entered
						if (batch_count >= 201) {
							$('<div inert class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>Oh Snap!</strong> The generator can\'t make more than 30 cards at once. Learn to read.</div>').prependTo(form);
						}
					}
					
					text.val(_.without(text.val().split('\n'), "").join('\n').replace(/\\x{201C}|\\x{201D}/g, '"').replace(/\\x{2019\}/g, "'"));

					e.preventDefault();
				});

				$('#generate-button').click(function(e){$('#generator').submit();});
			});
			
			var view_batch = function(batch, batch_count, img_file_prefix) {
				var modalBody = $('#batchModal .modal-body').empty(),
					row = $('<div>').attr("class", "row").appendTo(modalBody),
					i = 0,
					spinner = new Image(),
					col,
					max_attempts = 90,
					loadImages = function(attempt){
						var img = new Image();
						var padded_i = String(i).padStart(3, '0');
//						var imgURL = 'files/' + batch + '/' + img_file_prefix  + '_' + padded_i + '.png';
						var imgURL = './files/' + batch + '/' + img_file_prefix  + '_' + padded_i + '.png';


						if ($(col).html() != $(spinner).get(0).outerHTML) {
							col = $('<div>').attr({
								"class": "col-md-4",
								style: "text-align: center;"
							}).appendTo(row);

							$(col).html($(spinner));
						}

						//$(img).load(function(){
						//$(window).load(function(){...});
						//$(window).on('load', function(){ ...});
						$(img).on('load', function(){
							$(col).html($(this));
							i++;
							if (i < batch_count) {
							    loadImages(0);
							}
						}).attr({
							src: imgURL,
							width: '100%',
							style: 'border: 1px solid #888; border-radius: 15px; box-shadow: 1px 1px 1px 1px #999'
						}).on('error', function(){
							attempt++;
							if (attempt < max_attempts) {
							    setTimeout(function(){loadImages(attempt)}, 8000);
							}
						});
					}

				$(spinner).attr({
					src: "img/preloader_transparent.gif"
				});

				loadImages(0);
				loadImages(1);						
			}
			
        </script>
    </body>
</html>

